<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calendrier 4 semaines - sombre responsive</title>

<style>
:root{
  --bg:#101214; 
  --card:#1c1f23;
  --muted:#777;
  --text:#eaeaea;
  --gap:4px; 
  --days-font:14px;
  --event-font:13px;
  --color-reception:#109c53; 
  --color-smr:#5768cb;
  --title-color:#00e5ff;
  --border:#aaa;
}
body{
  margin:0;
  font-family:Inter, system-ui, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  padding:16px;
  box-sizing:border-box;
}
.container{
  max-width:100%;
  margin:0 auto;
}
header{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:16px;
  margin-bottom:12px;
}
header h1{
  margin:0;
  font-size:24px;
  color:var(--title-color);
  text-align:center;
}
.nav-btn{
  cursor:pointer;
  font-size:22px;
  font-weight:bold;
  color:var(--text);
  user-select:none;
}

.calendar {
  background: var(--card);
  border-radius:16px;
  padding:16px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.5);
  width:100%;
  overflow-x:auto;
}

.grid {
  display:grid;
  grid-template-columns: repeat(7, 1fr);
  gap: var(--gap);
}

.day {
  background: #1c1f23;
  border-radius:12px;
  min-height:150px; 
  padding:12px;
  box-sizing:border-box;
  border:1px solid var(--border);
  overflow:hidden;
  transition: all 0.2s;
  color: var(--text);
  position:relative;
}

.day.today {
  transform: scale(1.08);
  z-index:1;
  background-color: #2a2d31;
}

.day.past {
  background-color: #2f3236; 
  color:#aaa;
}

.day.future {
  background-color: #141619; 
  color:#eaeaea;
}

.day-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:var(--days-font);
  margin-bottom:6px;
  flex-direction: row-reverse;
}

.day .date {
  font-weight:600;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

.events {
  display:flex;
  flex-direction:column;
  gap:3px;
  overflow:hidden;
  max-height: calc((100vh - 250px)/4);
}

.event {
  display:flex;
  gap:6px;
  align-items:flex-start;
  font-size:var(--event-font);
  line-height:1.1;
  overflow:hidden;
  cursor:pointer;
  background:none;
}

.event .time { min-width:40px; font-weight:600; font-size:12px; }
.event .title { flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

.event.allDay .time { display:none; }

.event.more {
  font-size:12px;
  color:var(--muted);
  padding-left:6px;
}

.c-reception { color: var(--color-reception); }
.c-smr { color: var(--color-smr); }

.day.past .event { opacity:0.5; color:#999; }
.day.past .event .time { color:#999; }

@media(max-width:900px){ .grid { grid-template-columns: repeat(2, 1fr); } }
@media(max-width:520px){ .grid { grid-template-columns: repeat(1, 1fr); } }

#event-modal{
  display:none;
  position:fixed;
  top:50%; left:50%;
  transform:translate(-50%,-50%);
  background:#1c1f23;
  padding:30px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
  z-index:1000;
  color:#eaeaea;
  max-width:500px;
  width:90%;
}
#event-modal h2{ margin-top:0; font-size:22px; color:#eaeaea; }
#modal-overlay{
  display:none;
  position:fixed; top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.5);
  z-index:999;
}
#event-modal .close-btn{
  display:inline-block;
  margin-top:15px;
  padding:6px 14px;
  background:#333;
  color:#fff;
  border-radius:8px;
  cursor:pointer;
}
</style>
</head>
<body>
<div class="container">
  <header>
    <span class="nav-btn" id="prev-week">&lt;</span>
    <h1 id="month-title">Mois</h1>
    <span class="nav-btn" id="next-week">&gt;</span>
  </header>
  <div class="calendar" id="calendar-root">
    <div class="grid" id="grid"></div>
  </div>
</div>

<div id="modal-overlay"></div>
<div id="event-modal">
  <h2 id="modal-title"></h2>
  <p id="modal-start"></p>
  <p id="modal-end"></p>
  <p id="modal-desc"></p>
  <div class="close-btn" onclick="closeModal()">Fermer</div>
</div>

<script>
// --- CONFIG ---
const API_KEY = 'AIzaSyDkQkqPoOGf8umYg2dbeTU0THfLlJnCjXo';
const CALENDARS = [
  { id: 'receptionroulier@gmail.com', key: 'reception', css: 'c-reception' },
  { id: 'smr.programme@gmail.com', key: 'smr', css: 'c-smr' }
];
const WEEKS=4;

// --- HELPERS ---
function fmtDate(d){ return d.toISOString().split('T')[0]; }
function pad(n){ return n<10?'0'+n:n; }
function fmtTime(dt){ if(!dt) return ''; const d=new Date(dt); return pad(d.getDate())+'/'+pad(d.getMonth()+1)+' '+pad(d.getHours())+':'+pad(d.getMinutes()); }
function escapeHtml(s){ return String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]); }

let gridStart;

function renderCalendar(startDate){
  gridStart = new Date(startDate);
  const today=new Date();
  const dates=[];
  for(let w=0;w<WEEKS;w++){
    for(let i=0;i<7;i++){
      const d=new Date(gridStart);
      d.setDate(gridStart.getDate()+w*7+i);
      dates.push(new Date(d));
    }
  }

  const monthNames=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"];
  document.getElementById('month-title').textContent = monthNames[today.getMonth()]+' '+today.getFullYear();

  const gridEl=document.getElementById('grid');
  gridEl.innerHTML='';
  dates.forEach(d=>{
    const dayEl=document.createElement('div');
    dayEl.className='day';
    dayEl.dataset.date=fmtDate(d);
    dayEl.innerHTML=`
      <div class="day-header">
        <div class="date">${d.getDate()}</div>
        <div class="dow">${['Dim','Lun','Mar','Mer','Jeu','Ven','Sam'][d.getDay()]}</div>
      </div>
      <div class="events"></div>
    `;
    gridEl.appendChild(dayEl);
  });

  const todayStr = fmtDate(today);
  fo
